ğŸ—ï¸ Projeto de Web Scraping ImobiliÃ¡rio â€“ Idealista, OLX, Imovirtual (Resumo TÃ©cnico)
ğŸ¯ Objetivo
O objetivo do projeto foi criar um sistema de coleta de dados imobiliÃ¡rios de sites em Portugal, com possibilidade de expansÃ£o para coleta de notÃ­cias e outros dados no futuro. A ideia era criar um scraper reutilizÃ¡vel, modular e eficiente, que salve os dados em CSV, para futuras anÃ¡lises.

ğŸ”¶ ETAPA 1 â€“ Primeira versÃ£o do scraper (Idealista com requests e BeautifulSoup)
O que fizemos:
Criamos o projeto com pastas (scrapers/) e o arquivo main.py.

Tentamos coletar imÃ³veis da pÃ¡gina do Idealista usando:

python
Copiar
Editar
import requests
from bs4 import BeautifulSoup
âŒ Problema:
O requests sÃ³ acessa o HTML estÃ¡tico.

O conteÃºdo da lista de imÃ³veis do Idealista Ã© carregado por JavaScript.

Resultado: 0 imÃ³veis encontrados, CSV vazio.

âœ… SoluÃ§Ã£o aplicada:
Migramos para o uso do Selenium, que abre o navegador de verdade e renderiza o conteÃºdo dinamicamente.

ğŸ”· ETAPA 2 â€“ Usando Selenium para acessar o Idealista
O que fizemos:
Implementamos o scraping com Selenium (ChromeDriver via webdriver_manager).

Adicionamos tratamento de cookies:

python
Copiar
Editar
EC.element_to_be_clickable((By.ID, "didomi-notice-agree-button"))
âœ… Resultado:
O navegador abriu corretamente.

A pÃ¡gina do Idealista foi carregada.

ComeÃ§amos a coletar os imÃ³veis com tÃ­tulo, preÃ§o e link.

Salvamos em CSV com sucesso.

ğŸ”¶ ETAPA 3 â€“ Primeira quebra: CAPTCHA do Idealista
âŒ Problema:
ApÃ³s rodar algumas vezes, o Idealista passou a exibir um CAPTCHA (anti-bot).

O Selenium tradicional foi detectado.

âœ… SoluÃ§Ã£o proposta:
Usar undetected-chromedriver (nÃ£o foi implementado ainda, mas recomendado).

Adicionar time.sleep() para dar tempo do usuÃ¡rio resolver o CAPTCHA manualmente.

ğŸ”· ETAPA 4 â€“ AdiÃ§Ã£o de suporte a mÃºltiplos sites (scrape(site))
O que fizemos:
Refatoramos o cÃ³digo para aceitar diferentes sites como parÃ¢metro.

Criamos um dicionÃ¡rio com URLs:

python
Copiar
Editar
SITE_URLS = {
    "idealista": "...",
    "olx": "...",
    "casasapo": "...",
    "imovirtual": "..."
}
Estruturamos o scraping com if site == ... para adaptar seletores por site.

ğŸŸ  ETAPA 5 â€“ Tentativa com OLX
âŒ Problema:
A primeira URL testada estava incorreta â†’ pÃ¡gina â€œnÃ£o encontradaâ€.

âœ… SoluÃ§Ã£o:
Corrigimos manualmente a URL apÃ³s acessar diretamente pelo navegador.

Resultado: navegador abriu, mas o HTML da OLX Ã© diferente do Idealista.

âœ… SoluÃ§Ã£o adicional:
Adaptamos os seletores especÃ­ficos da OLX com:

python
Copiar
Editar
"div[data-cy='l-card']"
ExtraÃ­mos tÃ­tulo, preÃ§o e link com base no novo HTML.

ğŸ”µ ETAPA 6 â€“ Tentativa com Imovirtual
O que fizemos:
Usamos Selenium para abrir a pÃ¡gina com resultados de imÃ³veis em Lisboa.

âŒ Problemas sucessivos:
Seletores como h2, p[data-cy='listing-item-price'] nÃ£o existiam.

Erros do tipo no such element.

O site carrega conteÃºdo dinamicamente com JavaScript â†’ os dados ainda nÃ£o estavam no DOM quando o Selenium tentava buscar.

âœ… Tentativas de mitigaÃ§Ã£o:
Adicionamos WebDriverWait e time.sleep()

Inspecionamos o HTML real e testamos outros seletores.

âœ… SoluÃ§Ã£o definitiva:
Abandonamos seletores fixos para preÃ§o.

Pegamos o .text do link do anÃºncio e procuramos manualmente a linha com "â‚¬".

python
Copiar
Editar
linhas = anuncio.text.split("\n")
preco = next((linha for linha in linhas if "â‚¬" in linha), "PreÃ§o nÃ£o encontrado")
Assim, conseguimos coletar imÃ³veis mesmo que o HTML mude.

ğŸ”’ ETAPA 7 â€“ PrevenÃ§Ã£o de bloqueios e boas prÃ¡ticas
Riscos identificados:
Sites que detectam automaÃ§Ã£o podem bloquear IPs ou mostrar CAPTCHA.

Carregamento lento pode causar falha na leitura dos elementos.

âœ… Boas prÃ¡ticas implementadas:
Uso de WebDriverWait

Uso de time.sleep() entre interaÃ§Ãµes

AdiÃ§Ã£o da opÃ§Ã£o de headless=False para ver o navegador funcionando

RecomendaÃ§Ã£o de uso do modo anÃ´nimo (--incognito) se necessÃ¡rio

Proposta de undetected-chromedriver para casos de bloqueio

ğŸ§¾ RESULTADO FINAL
âœ… Scraper funcional para Idealista

âœ… Scraper funcional para Imovirtual

âœ… Estrutura pronta para OLX e Casa Sapo

âœ… Dados salvos automaticamente em .csv com nome por site

âœ… LÃ³gica adaptÃ¡vel para qualquer novo site no futuro

ğŸ—ƒï¸ Por que manter esse histÃ³rico armazenado?
ğŸ“– DocumentaÃ§Ã£o tÃ©cnica completa: vocÃª sabe o que foi feito e por quÃª.

ğŸ§© Facilita manutenÃ§Ã£o: se algo parar de funcionar, sabe exatamente onde mexer.

ğŸ” ReutilizaÃ§Ã£o de estrutura: vocÃª pode reaproveitar pra scraping de notÃ­cias, dados de mercado, etc.

ğŸ” Compliance: mostra que vocÃª respeitou boas prÃ¡ticas e conteÃºdo pÃºblico.

ğŸ§ª Aprendizado consolidado: Ã© uma aula prÃ¡tica de scraping moderno.

